services:
  kits-mock:
    image: fcp-dal-dev
    build:
      context: .
      target: development
    entrypoint: ['npm', 'run', 'start:mock']
    ports:
      - '5100:5100'
    env_file: .env.test
    environment:
      MOCK_LOG_LEVEL: http
      MOCK_SERVER_COLLECTION: all
      NODE_ENV: development
      PORT_MOCK: 5100
    networks:
      - cdp-tenant

  fcp-dal-api:
    image: fcp-dal-api
    build:
      context: .
    ports:
      - '5000:5000'
    env_file: .env.test
    environment:
      ALL_SCHEMA_ON: true
      DISABLE_AUTH: true
      LOG_LEVEL: http
      NODE_ENV: production
      PORT: 5000
      RP_KITS_GATEWAY_INTERNAL_URL: http://kits-mock:5100/v1/
    networks:
      - cdp-tenant

################################################################################

networks:
  cdp-tenant:
    driver: bridge
    name: cdp-tenant
